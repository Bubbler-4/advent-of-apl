 P9S←{
     p1←'= '∘#.U.Segs¨⍵
     cities←∪⊃,/{⍵[1 3]}¨p1  ⍝ Identify city names
     dmat←(2⍴≢cities)⍴0
     _←{
         (x _ y d)←⍵
         (x y)←cities⍳x y
         ⊢dmat[(x y)(y x)]←⍎d
     }¨p1  ⍝ Construct distance matrix
     ⌊/+/2{⍺ ⍵⌷dmat}/#.U.Pmat≢cities
 }
